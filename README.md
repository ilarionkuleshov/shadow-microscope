# Shadow Microscope

Проект позволяет исследовать жидкость на наличие микроскопических механических частиц и рассчитать их реальные размеры.

Составляющие проекта:

- теневой микроскоп на основе лазера и камеры;
- программа, которая позволяет обрабатывать полученные снимки.

<p align="center">
	<img src="./readme-imgs/photo1.png" height="350px"/>
</p>

## Устройство теневого микроскопа

На схеме показано как работает увеличение микроскопа на основе лазера:

<p align="center">
	<img src="./readme-imgs/schema.png" height="400px"/>
</p>

Лучи лазера преломляются при выходе из капли таким образом, что на экране мы видим увеличенные теневые проекции микрообъектов, которые находятся внутри капли. Капля жидкости выступает в роли линзы.

Я использовал обычную проточную воду. Получились подобные изображения:

<p align="center">
	<img src="./readme-imgs/photo2.png" height="350px"/>
</p>

Скорее всего это микрокусочки пыли, грязи.

Возле лазера установлен модуль ESP32-CAM с камерой, которая транслирует видеопоток в реальном времени на веб-сервер. Скетч для модуля ESP32-CAM был написан в среде Arduino IDE с использованием библиотеки: https://github.com/yoursunny/esp32cam

## Программа для обработки изображений

В первой вкладке программы находится виджет с мини-браузером, который отображает видеопоток. Во второй вкладке можно обработать изображение нейронной сетью и рассчитать реальные размеры микрообъектов:

<p align="center">
	<img src="./readme-imgs/screenshot.png" height="500px"/>
</p>

## Обучение нейросети

Сеть обучалась с помощью фреймворка Tensorflow, а именно Tensorflow Object Detection API. Архитектура сети - SSD MobileNet V2. Это довольно легкая сеть для решения задачи детектирования объектов на изображении.

Ноутбук для обучения сети в Google Colab: _app/neural-network/model_training.ipynb_

Обучение проводилось на собственном датасете. Оптимальное количество эпох - 100 тысяч.

## Установка необходимых библиотек / модулей для приложения

```
pip install pyside6
pip install numpy
pip install opencv-python
pip install tflite_runtime
```